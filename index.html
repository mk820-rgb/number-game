<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êï∞Â≠ó„Åß„ÇÑ„Å£„Å§„Åë„ÇçÔºÅ</title>
    <style>
        body { text-align: center; font-family: sans-serif; background: #f0f0f0; overflow: hidden; }
        #enemy { font-size: 100px; margin-top: 50px; transition: 0.5s; }
        #number { font-size: 120px; font-weight: bold; color: red; }
        #msg { font-size: 24px; color: #333; }
        .dead { transform: scale(0) rotate(360deg); opacity: 0; }
    </style>
</head>
<body>

    <div id="msg">Êï∞Â≠ó„Çí„Çà„Çì„Åß„Å≠ÔºÅ</div>
    <div id="enemy">üëæ</div> <div id="number"></div> <script>
        const enemy = document.getElementById('enemy');
        const numberDisplay = document.getElementById('number');
        const msg = document.getElementById('msg');
        
        let targetNumber;

        // 1. Êñ∞„Åó„ÅÑÊï∞Â≠ó„Å®Êïµ„ÇíÂá∫„Åô
        function spawn() {
            targetNumber = Math.floor(Math.random() * 10); // 0-9„ÅÆ„É©„É≥„ÉÄ„É†
            numberDisplay.innerText = targetNumber;
            enemy.classList.remove('dead');
            msg.innerText = "„Åì„Åà„Çí„Å†„Åó„Å¶ÔºÅ";
        }

        // 2. Èü≥Â£∞Ë™çË≠ò„ÅÆË®≠ÂÆö (iPhone SafariÂØæÂøú)
        const SpeechRecognition = window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'ja-JP';
        recognition.continuous = true;

        // 3. Â£∞„ÇíËÅ¥„ÅçÂèñ„Å£„ÅüÊôÇ„ÅÆÂá¶ÁêÜ
        recognition.onresult = (event) => {
            const transcript = event.results[event.results.length - 1][0].transcript;
            console.log("ËÅû„ÅçÂèñ„Å£„ÅüË®ÄËëâ:", transcript);

            if (transcript.includes(targetNumber.toString())) {
                msg.innerText = "„Ç¢„Çø„É™ÔºÅ„Åõ„ÅÑ„Åã„ÅÑÔºÅ";
                enemy.classList.add('dead');
                setTimeout(spawn, 1500); // 1.5ÁßíÂæå„Å´Ê¨°„Å∏
            } else {
                msg.innerText = `„Äå${transcript}„Äç„Åã„Å™Ôºü „Åä„Åó„ÅÑÔºÅ`;
            }
        };

        // ÁîªÈù¢„Çí„Çø„ÉÉ„Éó„Åó„Åü„ÇâÈñãÂßã
        window.onclick = () => {
            recognition.start();
            spawn();
            msg.innerText = "„Åç„ÅÑ„Å¶„Çã„Çà...";
        };
    </script>
</body>
</html>
